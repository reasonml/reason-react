<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Callback Handlers · ReasonReact</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Callback Handlers · ReasonReact"/><meta property="og:type" content="website"/><meta property="og:url" content="https://reasonml.github.io/reason-react/reason-react/index.html"/><meta property="og:description" content="Cette section décrit comment le code `&lt;div onClick={this.handleClick} /&gt;` React se traduit en ReasonReact."/><link rel="shortcut icon" href="/reason-react/img/reason-react-red.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css"/><link rel="alternate" type="application/atom+xml" href="https://reasonml.github.io/reason-react/blog/atom.xml" title="ReasonReact Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://reasonml.github.io/reason-react/blog/feed.xml" title="ReasonReact Blog RSS Feed"/><link rel="stylesheet" href="/reason-react/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/reason-react/"><img class="logo" src="/reason-react/img/reason-react-white.svg"/><h2 class="headerTitle">ReasonReact</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/reason-react/docs/fr/installation.html" target="_self">Documentation</a></li><li><a href="/reason-react/docs/fr/simple.html" target="_self">Exemples</a></li><li><a href="/reason-react/docs/fr/community.html" target="_self">Communauté</a></li><li><a href="/reason-react/blog" target="_self">Blogue</a></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/reason-react/img/language.svg"/>Français</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/reason-react/en">English</a></li><li><a href="/reason-react/es-ES">Español</a></li><li><a href="/reason-react/pt-BR">Português (Brasil)</a></li><li><a href="/reason-react/ru">Русский</a></li><li><a href="/reason-react/zh-CN">中文</a></li><li><a href="https://crowdin.com/project/reason-react" target="_blank">Aider à traduire</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(){
          if(languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/reasonml/reason-react" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Core</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Mise en route</h3><ul><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/what-why.html">Quoi &amp; Pourquoi</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/intro-example.html">Exemple d’introduction</a></li></ul></div><div class="navGroup navGroupActive"><h3>Core</h3><ul><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/creation-props-self.html">Creation, Props &amp; Self</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/jsx.html">JSX</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/render.html">Render</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/reason-react/docs/fr/callback-handlers.html">Callback Handlers</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/state-actions-reducer.html">State, Actions &amp; Reducer</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/lifecycles.html">Cycles de vie</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/instance-variables.html">Variables d’instance</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/react-ref.html">React Ref</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/interop.html">Interop With Existing ReactJS Components</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/event.html">Evènements</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/style.html">Style</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/clone-element.html">cloneElement</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/children.html">Children</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/dom.html">Travailler avec le DOM</a></li></ul></div><div class="navGroup navGroupActive"><h3>Équivalences ReactJS</h3><ul><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/invalid-prop-name.html">Invalid Prop Name</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/props-spread.html">Props Spread</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/component-as-prop.html">Component as Prop</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/ternary-shortcut.html">Ternary Shortcut</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/context-mixins.html">Context &amp; Mixins?</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/custom-class-component-property.html">Custom Class/Component Property</a></li></ul></div><div class="navGroup navGroupActive"><h3>FAQ</h3><ul><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/im-having-a-type-error.html">Je vais avoir une erreur de Type</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/record-field-reduce-handle-not-found.html">Record Field reduce/handle Not Found</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/reduce-handle-callbacks-having-incompatible-types.html">reduce/handle callbacks having Incompatible Types</a></li><li class="navListItem"><a class="navItem" href="/reason-react/docs/fr/i-really-need-feature-x-from-reactjs.html">J’ai vraiment besoin de la fonctionnalité X de ReactJS</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/reason-react/fr" target="_blank">Translate</a><h1>Callback Handlers</h1></header><article><div><span><p>Cette section décrit comment le code <code>&lt;div onClick={this.handleClick} /&gt;</code> React se traduit en ReasonReact.</p>
<h2><a class="anchor" aria-hidden="true" name="callback-sans-mise-a-jour-d-etat"></a><a href="#callback-sans-mise-a-jour-d-etat" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Callback sans mise à jour d'état</h2>
<p>Deux scénarios.</p>
<h3><a class="anchor" aria-hidden="true" name="sans-lire-dans-self"></a><a href="#sans-lire-dans-self" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sans lire dans <code>self</code></h3>
<p><em>Rappel : <code>self</code> est l'équivalent de <code>this</code> en React. C’est un 'record' qui contient des éléments comme <code>state</code>, <code>retainedProps</code> et autres.</em></p>
<p>Si vous propagez juste une propriété callback sur votre enfant, vous feriez exactement la même chose que vous auriez fait dans ReactJS :</p>
<pre><code class="hljs css reason">let component = ...;

let make = <span class="hljs-function"><span class="hljs-params">(~name, ~onClick, _children)</span> =&gt;</span> {
  ...component,
  render: <span class="hljs-function"><span class="hljs-params">(self)</span> =&gt;</span> &lt;button onClick=onClick /&gt;
};
</code></pre>
<p>Pas de surprise ici. Puisque le JSX de Reason a <a href="https://reasonml.github.io/guide/language/jsx#punning">une syntaxe simplifiée</a>, ce <code>button</code> sera formatté en <code>&lt;button onClick /&gt;</code>.</p>
<p>De même, pour pré-traiter une valeur avant de l’envoyer retour au conteneur du composant :</p>
<pre><code class="hljs css reason"><span class="hljs-keyword">let</span> component = ...;

<span class="hljs-keyword">let</span> make = <span class="hljs-function">(<span class="hljs-params">~name, ~onClick, _children</span>) =&gt;</span> {
  <span class="hljs-keyword">let</span> click = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> onClick(name); <span class="hljs-comment">/* pass the name string up to the owner */</span>
  {
    ...component,
    <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">self</span>) =&gt;</span> &lt;button onClick=click /&gt;
  }
};
</code></pre>
<h3><a class="anchor" aria-hidden="true" name="utiliser-self"></a><a href="#utiliser-self" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Utiliser <code>self</code></h3>
<p>Pour accéder à <code>state</code>, <code>retainedProps</code> et les autres éléments de <code>self</code> depuis un callback, vous <strong>devez</strong> encapsuler le callback dans une niveau supplémentaire nommé <code>self.handle</code> :</p>
<pre><code class="hljs css reason"><span class="hljs-keyword">let</span> component = <span class="hljs-params">...</span>;
<span class="hljs-keyword">let</span> make = (~name, ~onClick, _children) =&gt; {
  <span class="hljs-keyword">let</span> click = (event, <span class="hljs-built_in">self</span>) =&gt; {
    onClick(event);
    Js.<span class="hljs-keyword">log</span>(<span class="hljs-built_in">self</span>.state);
  };
  {
    <span class="hljs-params">...</span>component,
    initialState: <span class="hljs-params">...</span>,
    render: (<span class="hljs-built_in">self</span>) =&gt; &lt;button onClick={<span class="hljs-built_in">self</span>.<span class="hljs-keyword">handle</span>(click)} /&gt;
  }
};
</code></pre>
<p><strong>Notez</strong> comment le callback <code>click</code> prend maintenant l'argument supplémentaire <code>self</code>. Formellement, <code>self.handle</code> attend un callback qui</p>
<ul>
<li>accepte le contenu <strong>simple</strong> que vous passeriez normalement à, par exemple, <code>handleClick</code></li>
<li>plus l’argument <code>self</code>,</li>
<li>ne retourne rien (càd <code>()</code>, càd <code>unit</code>).</li>
</ul>
<p><strong>Note 2</strong> : parfois, vous pourriez transmettre <code>handle</code> à des fonctions utilitaires. Passer le <code>self</code> complet à la place et <strong>annotez le</strong>. Cela évite un comportement complexe pour <code>self</code> de type record. Voir <a href="/reason-react/docs/fr/record-field-reduce-handle-not-found.html">Record Field <code>reduce</code>/<code>handle</code> Not Found</a>.</p>
<h4><a class="anchor" aria-hidden="true" name="explication"></a><a href="#explication" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Explication</h4>
<p>En réalité, <code>self.handle</code> est juste une fonction standard acceptant deux paramètres, le premier étant le callback en question, et le second étant le contenu qui est censé être passé au callback.</p>
<p>Clair ? En utilisant la capacité naturelle de &quot;currying&quot; de Reason au niveau langage, nous vous demandons seulement de passez le premier argument. Cela retourne une nouvelle fonction qui attend le second argument et exécute le corps de la fonction. Le deuxième argument étant passé par l’appelant, c'est à dire le composant dont vous êtes en train de faire le rendu !</p>
<h4><a class="anchor" aria-hidden="true" name="callback-recevant-plusieurs-arguments"></a><a href="#callback-recevant-plusieurs-arguments" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Callback recevant plusieurs arguments</h4>
<p>Parfois, le composant que vous appelez provient de JavaScript (grâce à <a href="/reason-react/docs/fr/interop.html">l'interopérabilité ReasonReact &lt;-&gt; ReactJS</a>), et sa propriété callback s'attend que vous passiez un callback qui reçoit plus d'un paramètre. En ReactJS, cela ressemble à :</p>
<pre><code class="hljs css javascript">handleSubmit: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">username, password, event</span>) </span>{
  <span class="hljs-keyword">this</span>.setState(...)
}
...
&lt;MyForm onUserClickedSubmit={<span class="hljs-keyword">this</span>.handleSubmit} /&gt;
</code></pre>
<p>Vous ne pouvez pas écrire un tel <code>handleSubmit</code> en ReasonReact, simplement car <code>handle</code> s'attend à être décoré par une fonction qui ne prend qu'<strong>un</strong> paramètre. Voici comment contourner ce problème :</p>
<pre><code class="hljs css reason">let handleSubmitEscapeHatch = <span class="hljs-function"><span class="hljs-params">(username, password, event)</span> =&gt;</span>
        self.handle(<span class="hljs-function"><span class="hljs-params">(tupleOfThreeItems)</span> =&gt;</span> doSomething(tupleOfThreeItems))(username, password, event));
...
&lt;MyForm onUserClickedSubmit=(handleSubmitEscapeHatch) /&gt;
</code></pre>
<p>Foncièrement, vous écrivez une fonction qui :</p>
<ul>
<li>accepte les nombreux paramètres de la propriété callback du composant JS,</li>
<li>les regroupe dans un tuple et appelle <code>self.handle</code>,</li>
<li>transmet à <code>handle</code> la fonction standard qui n'attend qu'un seul paramètre,</li>
<li>finish calling <code>self.handle</code> by passing the tuple directly yourself.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" name="callback-avec-mise-a-jour-d-etat"></a><a href="#callback-avec-mise-a-jour-d-etat" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Callback avec mise à jour d'état</h2>
<p>Vous ne pouvez pas mettre à jour l'état dans <code>self.handle</code> ; vous devez utiliser <code>self.reduce</code> à la place. Voir la section suivante.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="render.html">← Render</a><a class="docs-next button" href="state-actions-reducer.html">State, Actions &amp; Reducer →</a></div></div></div></div><span><script src="/reason-react/js/redirectBlog.js"></script><script src="/reason-react/js/pjax-api.js"></script><script>window.foo = new Pjax({
          areas: [
            // try to use the first query.
            '.mainContainer, .docsNavContainer .toc .navWrapper',
            // fallback
            'body'
          ],
          link: '.docsNavContainer:not(.docsSliderActive) a',
          update: {
            script: false,
          }
        });
        var languagesMenuItemCopy = document.getElementById("languages-menu");
        languagesMenuItemCopy.addEventListener("click", function(e){
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
        });</script></span></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                apiKey: '55156da6520de795d3a2c2d23786f08e',
                indexName: 'react-reason',
                inputSelector: '#search_input_react'
              });
            </script></body></html>